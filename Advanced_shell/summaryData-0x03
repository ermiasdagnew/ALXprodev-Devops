#!/bin/bash
# Task 3: Summarize PokÃ©mon data (using jq, awk, sed)

OUTPUT_CSV="pokemon_report.csv"
DATA_DIR="pokemon_data"

# CSV header
echo "Name,Height (m),Weight (kg)" > "$OUTPUT_CSV"

total_height=0
total_weight=0
count=0

for f in "$DATA_DIR"/*.json; do
    # Extract raw values
    name=$(jq -r '.name' "$f")
    height=$(jq -r '.height' "$f")
    weight=$(jq -r '.weight' "$f")
    
    # Capitalize name using sed
    name=$(echo "$name" | sed 's/.*/\u&/')
    
    # Append to CSV
    echo "${name},${height},${weight}" >> "$OUTPUT_CSV"
    
    # Sum for averages
    total_height=$(awk "BEGIN {print $total_height+$height}")
    total_weight=$(awk "BEGIN {print $total_weight+$weight}")
    count=$((count+1))
done

# Calculate averages using awk
avg_height=$(awk "BEGIN {print $total_height/$count}")
avg_weight=$(awk "BEGIN {print $total_weight/$count}")

# Output
echo "CSV Report generated at: $OUTPUT_CSV"
echo "Average Height: $avg_height m"
echo "Average Weight: $avg_weight kg"
